---
title: '[정보처리기사 자격증] 3.데이터베이스 구축 > 4장 SQL 활용 (WEEK 6)'
date: '2026-01-21'
tags: ['dev', 'license']
draft: false
summary: 정보처리기사 6주차 내용정리 - SQL 활용
# https://velog.io/@alpaka206/79.-SQL의-개념
---

import ImageWithCaption from '@/components/mdxComponents/ImageWithCaption'

### 1. 프로시저(Procedure)

1. **프로시저란?**

   > **한 줄 정의:** 절차형 SQL을 활용하여 특정 기능을 수행하는 **저장된 SQL 작업 단위** (호출해서 실행)

2. **프로시저 핵심 개념**

   | 항목      | 내용                            |
   | --------- | ------------------------------- |
   | 별칭      | **스토어드(Stored) 프로시저**   |
   | 저장 위치 | **데이터베이스**                |
   | 실행 방식 | **호출**을 통해 실행            |
   | 활용      | 일일 마감, **일괄(Batch) 작업** |

3. **특징**
   - DB에 저장 → **여러 프로그램에서 호출** 가능
   - 재사용성 ↑, 유지보수 용이

4. **프로시저 구성 6가지**

   | 구성 요소       | 한 줄 정의                         |
   | --------------- | ---------------------------------- |
   | **DECLARE**     | 명칭, 변수, 인수, 타입 **선언**    |
   | **BEGIN/END**   | 프로시저 **시작/종료**             |
   | **CONTROL**     | **조건문/반복문** 처리             |
   | **SQL**         | DML, DCL로 **데이터 관리**         |
   | **EXCEPTION**   | **예외 처리** 정의                 |
   | **TRANSACTION** | COMMIT/ROLLBACK **적용 여부** 결정 |

   ```
   ┌─────────────────────────────┐
   │  DECLARE (선언부)             │
   ├─────────────────────────────┤
   │  BEGIN                      │
   │  ├── CONTROL (제어문)         │
   │  ├── SQL (DML, DCL)         │
   │  ├── EXCEPTION (예외처리)     │
   │  └── TRANSACTION (적용/취소)  │
   │  END                        │
   └─────────────────────────────┘
   ```

5. **프로시저 생성 (CREATE)**
   1. 기본 문법

      ```sql
      CREATE [OR REPLACE] PROCEDURE 프로시저명(파라미터)
      [지역변수 선언]
      BEGIN
        프로시저 BODY;
      END;
      ```

   2. 파라미터 유형 (시험 필수!)

      | 파라미터  | 한 줄 정의                    | 방향 |
      | :-------: | ----------------------------- | :--: |
      |  **IN**   | 호출 → 프로시저로 값 **전달** |  →   |
      |  **OUT**  | 프로시저 → 호출로 값 **반환** |  ←   |
      | **INOUT** | **전달 + 반환** 둘 다         |  ↔  |

   3. 예제

      ```sql
      -- 사원번호를 받아 지급방식을 'S'로 변경하는 프로시저
      CREATE OR REPLACE PROCEDURE emp_change_s(i_사원번호 IN INT)
      IS
      BEGIN
        UPDATE 급여 SET 지급방식 = 'S' WHERE 사원번호 = i_사원번호;
        EXCEPTION
          WHEN PROGRAM_ERROR THEN
            ROLLBACK;
        COMMIT;
      END;
      ```

   4. 예제 해설

      | 줄  | 내용                                |
      | :-: | ----------------------------------- |
      |  1  | 프로시저 생성, 파라미터 IN으로 받음 |
      |  2  | IS: 변수 선언부 (없으면 생략)       |
      |  3  | BEGIN: 프로시저 시작                |
      |  4  | SQL문 (UPDATE) 실행                 |
      | 5-7 | 예외 발생 시 ROLLBACK               |
      |  8  | 정상 종료 시 COMMIT                 |
      |  9  | END: 프로시저 종료                  |

6. **프로시저 실행 (EXECUTE / CALL)**
   1. 문법

      ```sql
      EXECUTE 프로시저명;
      EXEC 프로시저명;      -- 줄임말
      CALL 프로시저명;
      ```

   2. 예제

      ```sql
      -- 사원번호 32를 인수로 프로시저 실행
      EXECUTE emp_change_s(32);
      ```

7. **프로시저 제거 (DROP)**
   1. 문법

      ```sql
      DROP PROCEDURE 프로시저명;
      ```

   2. 예제

      ```sql
      DROP PROCEDURE emp_change_s;
      ```

8. **프로시저 명령어 정리**

   |   작업   | 명령어                        |
   | :------: | ----------------------------- |
   | **생성** | CREATE [OR REPLACE] PROCEDURE |
   | **실행** | EXECUTE / EXEC / CALL         |
   | **삭제** | DROP PROCEDURE                |

---

### 2. 트리거(Trigger)

1. **트리거란?**

   > **한 줄 정의:** INSERT, UPDATE, DELETE 이벤트 발생 시 **자동으로 실행**되는 절차형 SQL

2. **트리거 핵심 개념**

   | 항목      | 내용                                |
   | --------- | ----------------------------------- |
   | 실행 방식 | **자동 실행** (이벤트 발생 시)      |
   | 저장 위치 | **데이터베이스**                    |
   | 용도      | 무결성 유지, 로그 출력, 데이터 변경 |
   - 주의사항
     - **DCL 사용 불가!** (COMMIT, ROLLBACK, GRANT, REVOKE 등)
     - DCL 포함된 프로시저/함수 호출도 오류 발생
     - 트리거 오류 → 데이터에도 영향

3. **프로시저 vs 트리거**

   |      구분       |     프로시저      |     트리거     |
   | :-------------: | :---------------: | :------------: |
   |    실행 방식    | **호출**해서 실행 | **자동** 실행  |
   |    실행 시점    |      원할 때      | 이벤트 발생 시 |
   |    DCL 사용     |      ⭕ 가능      |  ❌ **불가**   |
   | COMMIT/ROLLBACK |      ⭕ 가능      |  ❌ **불가**   |

4. **트리거 구성**

   | 구성 요소     | 한 줄 정의                      |
   | ------------- | ------------------------------- |
   | **DECLARE**   | 명칭, 변수, 상수, 타입 **선언** |
   | **EVENT**     | 트리거 실행 **조건** 명시       |
   | **BEGIN/END** | 트리거 **시작/종료**            |
   | **CONTROL**   | 조건문/반복문                   |
   | **SQL**       | **DML**문으로 데이터 관리       |
   | **EXCEPTION** | 예외 처리                       |

   ```
   ┌─────────────────────────────┐
   │  DECLARE (선언부)             │
   │  EVENT (이벤트 조건)           │
   ├─────────────────────────────┤
   │  BEGIN                      │
   │  ├── CONTROL (제어문)         │
   │  ├── SQL (DML만!)            │
   │  └── EXCEPTION (예외처리)     │
   │  END                        │
   └─────────────────────────────┘
   ```

5. **트리거 생성 (CREATE)**
   1. 기본 문법

      ```sql
      CREATE [OR REPLACE] TRIGGER 트리거명 동작시기 동작 ON 테이블명
      [REFERENCING NEW | OLD AS 테이블명]
      [FOR EACH ROW [WHEN 조건식]]
      BEGIN
      트리거 BODY;
      END;
      ```

   2. **동작시기**

      |    시기    | 한 줄 정의                |
      | :--------: | ------------------------- |
      | **BEFORE** | 테이블 변경 **전**에 실행 |
      | **AFTER**  | 테이블 변경 **후**에 실행 |

   3. **동작**

      |    동작    | 한 줄 정의            |
      | :--------: | --------------------- |
      | **INSERT** | 튜플 **삽입** 시 실행 |
      | **UPDATE** | 튜플 **수정** 시 실행 |
      | **DELETE** | 튜플 **삭제** 시 실행 |

   4. NEW vs OLD

      |  구분   | 한 줄 정의                 | 사용 시점      |
      | :-----: | -------------------------- | -------------- |
      | **NEW** | **추가/수정될** 튜플 집합  | INSERT, UPDATE |
      | **OLD** | **수정/삭제 전** 튜플 집합 | UPDATE, DELETE |

   5. 기타 키워드

      | 키워드           | 한 줄 정의              |
      | ---------------- | ----------------------- |
      | **FOR EACH ROW** | 각 튜플마다 트리거 적용 |
      | **WHEN 조건식**  | 트리거 적용할 튜플 조건 |

   6. 트리거 예제

      ```sql
      -- 학생 테이블에 삽입 시 학년이 NULL이면 '신입생' 설정
      CREATE TRIGGER 학년정보_tri BEFORE INSERT ON 학생
      REFERENCING NEW AS new_table
      FOR EACH ROW
      WHEN (new_table.학년 IS NULL)
      BEGIN
      :new_table.학년 := '신입생';
      END;
      ```

   7. 예제 해설

      | 줄  | 설명                              |
      | :-: | --------------------------------- |
      |  1  | **BEFORE INSERT**: 삽입 전에 실행 |
      |  2  | **NEW**를 new_table로 별칭        |
      |  3  | 모든 튜플에 적용                  |
      |  4  | 학년이 NULL인 경우만              |
      |  5  | 학년에 '신입생' **치환**          |

   8. 문법 주의
      - NEW/OLD 테이블 참조 시 앞에 **콜론(:)** 붙임
      - 치환 연산자는 **:=** 사용 (= 아님!)

6. **트리거 제거 (DROP)**

   ```sql
   DROP TRIGGER 트리거명;
   ```

   1. 예제

      ```sql
      DROP TRIGGER 학년정보_tri;
      ```

7. **트리거 명령어 정리**

   |   작업   | 명령어                      |
   | :------: | --------------------------- |
   | **생성** | CREATE [OR REPLACE] TRIGGER |
   | **삭제** | DROP TRIGGER                |

   💡 **주의:** 트리거는 **실행 명령어 없음!** (자동 실행이니까)

---

### 3. 사용자 정의 함수

1. **사용자 정의 함수란?**

   > **한 줄 정의:** 일련의 작업을 처리한 후 **단일값을 반환**하는 절차형 SQL (RETURN으로 반환)

2. **사용자 정의 함수 핵심 개념**

   | 항목          | 내용                                     |
   | ------------- | ---------------------------------------- |
   | 반환값        | **반드시 1개** (RETURN 사용)             |
   | 파라미터      | **입력(IN)만** 가능 (OUT 없음)           |
   | 사용 가능 SQL | **SELECT만** (조회만 가능)               |
   | 호출 위치     | **DML문** 안에서 호출                    |
   | 용도          | SUM(), AVG() 같은 **내장 함수**처럼 사용 |

3. **주의사항**
   - **INSERT, UPDATE, DELETE 불가!** (테이블 조작 X)
   - **프로시저 호출 불가!**
   - 출력 파라미터(OUT) 없음 → RETURN으로 반환

4. **프로시저 vs 사용자 정의 함수 vs 트리거**

   |     구분      |      프로시저      | 사용자 정의 함수 |  트리거  |
   | :-----------: | :----------------: | :--------------: | :------: |
   |  **반환값**   | 없거나 **여러 개** |  **반드시 1개**  |   없음   |
   | **파라미터**  |   IN, OUT, INOUT   |     **IN만**     |   없음   |
   | **사용 SQL**  |      DML, DCL      |   **SELECT만**   |  DML만   |
   | **실행 방식** |    **EXECUTE**     |  **DML에 포함**  | **자동** |
   | **호출 대상** |   프로시저, 함수   |    **함수만**    |    -     |

5. **사용자 정의 함수 구성**

   | 구성 요소     | 한 줄 정의                      |
   | ------------- | ------------------------------- |
   | **DECLARE**   | 명칭, 변수, 인수, 타입 **선언** |
   | **BEGIN/END** | 함수 **시작/종료**              |
   | **CONTROL**   | 조건문/반복문                   |
   | **SQL**       | **SELECT**문으로 조회           |
   | **EXCEPTION** | 예외 처리                       |
   | **RETURN**    | 반환값 정의 ⭐                  |

   ```
   ┌─────────────────────────────┐
   │  DECLARE (선언부)             │
   ├─────────────────────────────┤
   │  BEGIN                      │
   │  ├── CONTROL (제어문)         │
   │  ├── SQL (SELECT만!)        │
   │  ├── EXCEPTION (예외처리)     │
   │  └── RETURN (반환값) ⭐       │
   │  END                        │
   └─────────────────────────────┘
   ```

   💡 **프로시저와 차이:** RETURN이 추가됨!

6. **사용자 정의 함수 생성 (CREATE)**
   1. 기본 문법

      ```sql
      CREATE [OR REPLACE] FUNCTION 함수명(파라미터)
      RETURN 자료형
      [지역변수 선언]
      BEGIN
      함수 BODY;
      RETURN 반환값;
      END;
      ```

   2. 예제

      ```sql
      -- 성별코드 1이면 '남자', 아니면 '여자' 반환
      CREATE FUNCTION Get_S_성별(i_성별코드 IN INT)
      RETURN VARCHAR2
      IS
      BEGIN
      IF i_성별코드 = 1 THEN
         RETURN '남자';
      ELSE
         RETURN '여자';
      END IF;
      END;
      ```

   3. 예제 해설

      | 줄  | 설명                               |
      | :-: | ---------------------------------- |
      |  1  | 함수 생성, 파라미터 **IN만** 가능  |
      |  2  | **RETURN 자료형** 정의 (크기 생략) |
      |  3  | IS: 변수 선언부                    |
      | 4-6 | IF문으로 조건 처리 후 **RETURN**   |

7. **사용자 정의 함수 실행**
   - **DML문에서 속성명/값 자리에 사용**
   1. 사용 방법

      ```sql
      -- SELECT에서 사용
      SELECT 함수명(속성명) FROM 테이블;

      -- INSERT에서 사용
      INSERT INTO 테이블(속성) VALUES (함수명(값));

      -- UPDATE에서 사용
      UPDATE 테이블 SET 속성 = 함수명(값);

      -- DELETE에서 사용 (WHERE 조건)
      DELETE FROM 테이블 WHERE 속성 = 함수명(값);
      ```

   2. 예제

      ```sql
      -- 사원 테이블에서 성별코드를 '남자/여자'로 변환하여 출력
      SELECT 이름, Get_S_성별(성별코드) FROM 사원;
      ```

      | 이름   | Get*S*성별(성별코드) |
      | ------ | :------------------: |
      | 김대진 |         남자         |
      | 이고을 |         여자         |

8. **사용자 정의 함수 제거 (DROP)**

   ```sql
   DROP FUNCTION 함수명;
   ```

   - 예제

     ```sql
     DROP FUNCTION Get_S_성별;
     ```

9. **명령어 정리**

   |   작업   | 프로시저          | 사용자 정의 함수 | 트리거         |
   | :------: | ----------------- | ---------------- | -------------- |
   | **생성** | CREATE PROCEDURE  | CREATE FUNCTION  | CREATE TRIGGER |
   | **실행** | EXECUTE/EXEC/CALL | **DML에 포함**   | **자동**       |
   | **삭제** | DROP PROCEDURE    | DROP FUNCTION    | DROP TRIGGER   |

---

### 4. DBMS 접속 기술

1. **DBMS 접속이란?**

   > **한 줄 정의:** 사용자가 **응용 시스템을 통해** DBMS에 접근하여 데이터를 사용하는 것

2. 웹 응용 시스템 구조

   ```
   [사용자] ↔ [웹 서버] ↔ [WAS] ↔ [DBMS]
   ```

   | 구성 요소   | 역할                                         |
   | ----------- | -------------------------------------------- |
   | **웹 서버** | 사용자 요청 수신, 서비스 요청 처리           |
   | **WAS**     | 요청을 **트랜잭션 언어로 변환** 후 DBMS 전달 |
   | **DBMS**    | 데이터 저장/관리                             |

   💡 서비스 규모가 **작으면** 웹 서버 + WAS **통합** 가능

3. **DBMS 접속 기술 3가지**

   |    기술     | 한 줄 정의                             |   개발사   |
   | :---------: | -------------------------------------- | :--------: |
   |  **JDBC**   | **Java**용 DB 접속 표준 API            | Sun (1997) |
   |  **ODBC**   | **개발 언어 무관** DB 접속 표준 API    | MS (1992)  |
   | **MyBatis** | JDBC 단순화 **SQL Mapping** 프레임워크 |  오픈소스  |
   1. JDBC (Java DataBase Connectivity)
      - **Java** 언어로 DB에 접속하고 SQL을 수행하는 **표준 API**

      | 항목      | 내용                              |
      | --------- | --------------------------------- |
      | 출시      | 1997년 썬 마이크로시스템          |
      | 포함 위치 | **Java SE** (java.sql, javax.sql) |
      | 필요 요소 | DBMS별 **드라이버** 필요          |
      | 특징      | Java 전용                         |

   2. ODBC (Open DataBase Connectivity)
      - **개발 언어에 관계없이** 사용할 수 있는 DB 접속 **표준 개방형 API**

      | 항목         | 내용                                  |
      | ------------ | ------------------------------------- |
      | 출시         | 1992년 마이크로소프트                 |
      | 접속 가능 DB | MS-Access, DBase, DB2, Excel, Text 등 |
      | 필요 요소    | DBMS별 **드라이버** 필요              |
      | 특징         | **드라이버 관리자**가 알아서 연결     |

      💡 DBMS **인터페이스를 몰라도** ODBC 문장으로 SQL 작성 가능!

   3. MyBatis
      - JDBC를 단순화한 **SQL Mapping** 기반 오픈소스 접속 **프레임워크**

      | 항목      | 내용                                  |
      | --------- | ------------------------------------- |
      | 기반      | JDBC 코드 단순화                      |
      | 특징      | SQL을 **XML 파일**에 분리             |
      | 실행 방식 | **Mapping**을 통해 SQL 실행           |
      | 장점      | SQL 거의 그대로 사용 → **SQL 친화적** |

      💡 **국내에서 많이 사용!** (SQL 친화적 환경에 적합)

   4. JDBC vs ODBC vs MyBatis

      |   구분   |     JDBC      |     ODBC      |    MyBatis     |
      | :------: | :-----------: | :-----------: | :------------: |
      |   언어   | **Java 전용** | **언어 무관** |      Java      |
      |   유형   |      API      |      API      | **프레임워크** |
      | SQL 위치 |    코드 내    |    코드 내    |  **XML 분리**  |
      | 드라이버 |     필요      |     필요      |   JDBC 기반    |

4. **동적 SQL vs 정적 SQL**
   1. 동적 SQL (Dynamic SQL)
      - SQL 코드를 **문자열 변수**에 넣어 **조건에 따라 변경** 처리
      - 동적 SQL 특징
        - 사용자로부터 SQL **일부/전부 입력** 받을 수 있음
        - **NVL 함수 불필요**
        - **프리컴파일 시 검사 불가** (구문 분석, 권한 확인 등)
        - 속도는 느리지만 **유연한 개발** 가능
   2. 정적 SQL (Static SQL)
      - SQL 코드를 **직접 기술** (변수에 담지 않음)
   3. 비교

      |     구분      |        정적 SQL         |          동적 SQL           |
      | :-----------: | :---------------------: | :-------------------------: |
      |   SQL 구성    | **커서** 통한 정적 처리 | **문자열 변수**에 동적 처리 |
      |   개발 패턴   |   커서 범위 내 반복문   |     로직 통해 SQL 작성      |
      | **실행 속도** |       **빠름** ⭕       |           느림 ❌           |
      | **사전 검사** |       **가능** ⭕       |          불가능 ❌          |
      |   NVL 함수    |          필요           |         **불필요**          |
      |    유연성     |          낮음           |         **높음** ⭕         |
